"use strict";(self["webpackChunkcxs_currency_sys_client"]=self["webpackChunkcxs_currency_sys_client"]||[]).push([[742],{10637:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"site-content clean content",staticStyle:{transform:"none"}},[t("MyBreadcrumb",{attrs:{breadcrumb:!0}}),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.lodding,expression:"lodding"}],staticClass:"content-area",attrs:{id:"primary","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[t("div",{staticClass:"toolbar"},[t("div",{staticClass:"toolbar-left"},[e._v(" 当前展示 "),e.pageQuery.typeId&&e.otherResult.type?t("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.otherResult.type.typeName)+" ")]):e._e(),e.pageQuery.tagId&&e.otherResult.tag?t("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.otherResult.tag.tagName)+" ")]):t("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.keyword)+" ")]),e._v(" 的搜索结果，共 "+e._s(e.count)+" 条数据 "),e.checkedTags&&e.checkedTags.length>0?t("span",[e._v(" 搜索标签: "),e._l(e.checkedTags,(function(a){return t("el-tag",{key:a.tagId,staticStyle:{margin:"3px"},attrs:{size:"small"}},[e._v(" "+e._s(a.tagName)+" ")])}))],2):e._e()])]),e.articleList&&e.articleList.length>0?t("main",{staticClass:"site-main",attrs:{role:"main"}},e._l(e.articleList,(function(e,a){return t("ArticleItem",{key:"a_"+a,attrs:{origin:2,article:e}})})),1):t("main",{staticClass:"site-main",attrs:{role:"main"}},[t("el-empty",{attrs:{description:"暂无更多匹配条件的结果"}})],1)]),t("div",{staticClass:"widget-area all-sidebar",attrs:{id:"sidebar"}},[t("aside",{staticClass:"widget widget_search"},[t("div",{staticClass:"searchbar"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,id:"searchform1"}},[t("div",{staticStyle:{"margin-bottom":"14px"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"排序方式"},model:{value:e.pageQuery.sort,callback:function(t){e.$set(e.pageQuery,"sort",t)},expression:"pageQuery.sort"}},e._l(e.sortList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("div",{staticClass:"search"},[t("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"请输入内容"},model:{value:e.pageQuery.keyWord,callback:function(t){e.$set(e.pageQuery,"keyWord",t)},expression:"pageQuery.keyWord"}}),t("el-button",{staticStyle:{width:"28%"},attrs:{type:"primary"},on:{click:function(t){return e.keyWordSearchSubmit()}}},[e._v("搜索")])],1)])],1),t("div",{staticClass:"clear"})]),t("MyTags",{attrs:{handle:e.clickTags}}),t("ArticleSide",{class:{fixed:e.fiexd},attrs:{title:"热门文章",list:e.sysRecommendArticleList}}),t("HotSearchSide",{attrs:{title:"推荐搜索",list:e.hotSearchArticleList}})],1)],1)},i=[],r=(a(28743),a(93518)),d=a(7164),c=a(21942),o=a(4754),l=a(48468),h=a(88618);const n=1,p=5;var g={name:"SearchDetail",components:{ArticleItem:d.A,MyTags:c.A,ArticleSide:l.A,HotSearchSide:h.A},watch:{"$route.query":{handler(e,t){""!==e.keyword&&e.keyword!==t.keyword&&(this.$store.dispatch("header/setbreadcrumbAppend",[e.keyword]),this.pageQuery.keyWord=e.keyword,this.getArticleDataList(1)),e.typeId&&e.typeId!==t.typeId&&(this.pageQuery.typeId=e.typeId,this.getArticleDataList(1)),e.tagId&&e.tagId!==t.tagId&&(this.pageQuery.tagId=e.tagId,this.getArticleDataList(1))}},"$route.params":{handler(e,t){e.typeId&&e.typeId!==t.typeId&&(this.pageQuery.typeId=e.typeId,this.$store.dispatch("header/setbreadcrumbAppend",this.getTypeArray()),this.getArticleDataList(1))}}},data(){return{breadcrumbList:[],checkedTag:[],keyword:"",otherResult:{},lodding:!1,noPage:!1,pageQuery:{keyWord:"",tags:[],typeId:void 0,tagId:void 0,sort:2,pageNum:1,pageSize:5},sortList:[{id:1,name:"阅读数优先"},{id:2,name:"发布时间优先"}],fiexd:!1,pages:0,count:0,oldScrollTop:0,articleList:[]}},computed:{...(0,r.L8)(["tagList","typeList","typeListArr","hotSearchArticleList","sysRecommendArticleList"]),checkedTags(){let e=[];if(this.otherResult.tags&&this.otherResult.tags.length>0)return e=this.tagList.map((e=>{if(-1!==this.otherResult.tags.indexOf(e.tagId))return e})).filter((e=>e)),e}},mounted(){this.init(),this.$nextTick((()=>{window.addEventListener("scroll",this.handleScroll)}))},beforeDestroy(){window.removeEventListener("scroll",this.handleScroll)},methods:{getTypeArray(){let e=[];const t=this.typeListArr.find((e=>e.id===this.pageQuery.typeId));return e.push(t?t.typeName:""),e},init(){this.pageQuery.keyWord=this.$route.query.keyword||"",this.pageQuery.typeId=this.$route.params.typeId?Number.parseInt(this.$route.params.typeId):void 0,this.pageQuery.tagId=this.$route.query.tagId?Number.parseInt(this.$route.query.tagId):void 0,this.pageQuery.typeId&&0!==this.pageQuery.typeId?this.$store.dispatch("header/setbreadcrumbAppend",this.getTypeArray()):this.$store.dispatch("header/setbreadcrumbAppend",[this.$route.query.keyword]),this.getArticleDataList(1)},clickTags(e){-1!==this.checkedTag.indexOf(e)?(this.checkedTag.splice(this.checkedTag.indexOf(e),1),this.pageQuery.tags.splice(this.pageQuery.tags.indexOf(e.tagId),1)):this.checkedTag&&this.checkedTag.length>=5?this.$message.warning("最多可同时搜索5个标签"):(this.checkedTag.push(e),this.pageQuery.tags.push(e.tagId))},handleClose(e){this.checkedTag.splice(this.checkedTag.indexOf(e),1),this.pageQuery.tags.splice(this.pageQuery.tags.indexOf(e.tagId),1)},keyWordSearchSubmit(){this.pageQuery={...this.pageQuery,pageNum:n,pageSize:p},""===this.pageQuery.keyWord?this.$store.dispatch("header/setbreadcrumbAppend",this.getTypeArray()):this.$store.dispatch("header/setbreadcrumbAppend",[this.pageQuery.keyWord]),this.getArticleDataList(1)},pageHandle(){this.pageQuery.pageNum<this.pages&&!this.noPage&&!this.lodding&&(this.pageQuery.pageNum=this.pageQuery.pageNum+1,this.getArticleDataList(0))},handleScroll(){let e=document.getElementById("sidebar");const t=e.offsetHeight;let a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,s=a-this.oldScrollTop;this.oldScrollTop=a,this.fiexd=a>t;let i=document.documentElement.clientHeight||document.body.clientHeight,r=document.documentElement.scrollHeight||document.body.scrollHeight;a+i>r-300&&s>=0&&this.pageHandle()},getArticleDataList(e){this.lodding=!0,1===e?(0,o.BJ)(this.pageQuery).then((e=>{this.lodding=!1,document.documentElement.scrollTop=0,this.count=e.data.total,this.keyword=e.data.keyword,this.otherResult=e.data.other;const t=e.data.data.sort(this.sortArticle(this.pageQuery.sort,"desc"));this.articleList=t,this.pages=e.data.pages,e.data.data&&0!==e.data.data.length||(this.noPage=!0),this.pageQuery.typeId&&0!==this.pageQuery.typeId?e.data.other.type&&this.$store.dispatch("header/setbreadcrumbAppend",[e.data.other.type.typeName]):this.pageQuery.tagId&&0!==this.pageQuery.tagId&&e.data.other.tag&&this.$store.dispatch("header/setbreadcrumbAppend",[e.data.other.tag.tagName])})):(0,o.BJ)(this.pageQuery).then((e=>{this.lodding=!1,this.count=e.data.total,this.keyword=e.data.keyword,this.otherResult=e.data.other;const t=this.articleList.concat(e.data.data).sort(this.sortArticle(this.pageQuery.sort,"desc"));this.articleList=t,this.pages=e.data.pages,e.data.data&&0!==e.data.data.length||(this.noPage=!0)}))},sortArticle(e,t){return(a,s)=>3===e?"desc"===t?s.articleRate-a.articleRate:a.articleRate-s.articleRate:2===e?"desc"===t?new Date(s.createTime)-new Date(a.createTime):new Date(a.createTime)-new Date(s.createTime):3===e?"desc"===t?s.readNum-a.readNum:a.readNum-s.readNum:void 0}}},u=g,y=a(81656),m=(0,y.A)(u,s,i,!1,null,"d17a505a",null),k=m.exports}}]);