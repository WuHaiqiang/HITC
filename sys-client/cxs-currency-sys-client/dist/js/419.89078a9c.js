"use strict";(self["webpackChunkcxs_currency_sys_client"]=self["webpackChunkcxs_currency_sys_client"]||[]).push([[419],{56419:function(t,e,i){i.r(e),i.d(e,{default:function(){return y}});var n={};i.r(n);var s=function(){var t=this,e=t._self._c;return e("div",[e("div",[e("button",{attrs:{type:"primary"},on:{click:t.pay}},[t._v("支付")])])])},o=[],c=i(94586),a=i(79323),l=i.n(a),u=i(43603),r=(i(7277),{name:"Test",components:{vueQr:l()},data(){return{selectPointType:1,pointTypeList:[],pointObj:{gold:100,id:1,money:"10.00",typeDesc:"购买100积分"},paySucc:!1,dialogVisible:!1,text:"",socket:null,timeout:1e4,timeoutObj:null,serverTimeoutObj:null,timeoutnum:null,lockReconnect:!1,websocket:null}},watch:{selectPointType:{immediate:!0,handler:function(t,e){if(this.startPay(),t){let e=null;this.pointTypeList.forEach((i=>{i.id==t&&(e=i)})),this.pointObj=e}}}},mounted(){this.init()},methods:{init(){(0,n.getPointRechargeTypeList)().then((t=>{this.pointTypeList=t.data}))},pay(){this.paySucc=!1,this.dialogVisible=!0,this.startPay();let t=null;this.pointTypeList.forEach((e=>{e.id==this.selectPointType&&(t=e)})),this.pointObj=t},startPay(){var t=(0,u.gf)();(0,c.l)({id:this.selectPointType}).then((e=>{this.text=e.data,this.dialogVisible=!0;const i=this;if("WebSocket"in window){var n=new WebSocket(`ws://${location.host}/websocket/bindingRecord/${t}`);n.onopen=function(){n.send("data")},n.onmessage=function(t){t.data;Boolean(t.data)&&(i.paySucc=!0,i.$message.success("交易成功"),setTimeout((()=>{i.dialogVisible=!1}),1e3)),n.close()}}else alert("您的浏览器不支持 WebSocket!")}))}}}),p=r,h=i(81656),d=(0,h.A)(p,s,o,!1,null,"0184af9c",null),y=d.exports}}]);