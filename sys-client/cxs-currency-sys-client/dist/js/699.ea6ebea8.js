"use strict";(self["webpackChunkcxs_currency_sys_client"]=self["webpackChunkcxs_currency_sys_client"]||[]).push([[699],{47699:function(e,r,t){t.r(r),t.d(r,{default:function(){return h}});var a=function(){var e=this,r=e._self._c;return r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"登录名",prop:"userName"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入登录名称，只能输入16位英文、数字、-、_",autocomplete:"off",maxlength:"16","show-word-limit":""},model:{value:e.ruleForm.userName,callback:function(r){e.$set(e.ruleForm,"userName",r)},expression:"ruleForm.userName"}})],1),r("el-form-item",{attrs:{label:"显示名",prop:"nickName"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入显示名称",autocomplete:"off",maxlength:"10","show-word-limit":""},model:{value:e.ruleForm.nickName,callback:function(r){e.$set(e.ruleForm,"nickName",r)},expression:"ruleForm.nickName"}})],1),r("el-form-item",{attrs:{label:"性别",prop:"sex"}},[r("el-radio-group",{model:{value:e.ruleForm.sex,callback:function(r){e.$set(e.ruleForm,"sex",r)},expression:"ruleForm.sex"}},[r("el-radio",{attrs:{label:1}},[e._v("男")]),r("el-radio",{attrs:{label:2}},[e._v("女")])],1)],1),r("el-form-item",{attrs:{label:"手机",prop:"phone"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入手机号",autocomplete:"off",maxlength:"11","show-word-limit":""},model:{value:e.ruleForm.phone,callback:function(r){e.$set(e.ruleForm,"phone",r)},expression:"ruleForm.phone"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入邮箱地址"},model:{value:e.ruleForm.email,callback:function(r){e.$set(e.ruleForm,"email",r)},expression:"ruleForm.email"}})],1),r("el-form-item",{attrs:{label:"签名",prop:"autograph"}},[r("el-input",{attrs:{type:"textarea",rows:3,resize:"none",maxlength:"50","show-word-limit":"",placeholder:"请输入个性签名"},model:{value:e.ruleForm.autograph,callback:function(r){e.$set(e.ruleForm,"autograph",r)},expression:"ruleForm.autograph"}})],1),r("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseUrl+"/base/file/upload",headers:e.header,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.ruleForm.avatar?r("img",{staticClass:"avatar",attrs:{src:e.baseUrl+e.ruleForm.avatar}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",[r("el-button",{staticStyle:{width:"100px","margin-right":"20px"},attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("提交")]),e._v(" "+e._s(e.userInfo.nickName)+"注册于:"+e._s(e.userInfo.createTime)+" ")],1)],1)},l=[],s=t(92549),o=t(52004),i=t(43603),u=t(93518),n={name:"Personal",data(){var e=(e,r,t)=>{const a=/^[A-Za-z0-9-_]+$/;if(!r)return t(new Error("登录名不能为空"));a.test(r)&&r.length<=16?(0,s.yp)({userName:r}).then((e=>{e.data?t(new Error("登录名已存在")):t()})):t(new Error("登录名格式不正确,须由数字、英文字母、-、下划线(不包含、)组成,不大于16位"))},r=(e,r,t)=>{if(!r)return t(new Error("展示名不能为空"));r.length<=10?t():t(new Error("展示名格式不正确,长度不大于10位"))},t=(e,r,t)=>{const a=/0?(13|14|15|17|18|19)[0-9]{9}/;r&&""!==r?a.test(r)?t():t(new Error("手机号格式不正确")):t()},a=(e,r,t)=>{const a=/\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14}/;r&&""!==r?a.test(r)?t():t(new Error("邮箱格式不正确")):t()};return{baseUrl:o.f,userInfo:{},ruleForm:{userName:"",nickName:"",avatar:"",sex:null,createTime:"",phone:"",email:"",autograph:""},rules:{userName:[{validator:e,trigger:"blur"}],nickName:[{validator:r,trigger:"blur"}],phone:[{validator:t,trigger:"blur"}],email:[{validator:a,trigger:"blur"}]}}},computed:{header(){return{access_token:(0,i.gf)()}},...(0,u.L8)(["user"])},mounted(){this.init()},methods:{init(){(0,s.xL)().then((e=>{this.userInfo=e.data,this.ruleForm=e.data}))},handleAvatarSuccess(e,r){this.ruleForm.avatar=e.data,this.$forceUpdate()},beforeAvatarUpload(e){const r="image/jpeg"===e.type,t="image/png"===e.type,a=e.size/1024/1024<2;return r||t||this.$message.error("上传头像图片只能是 jpg或png 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),r&&a||t&&a},submitForm(e){const{userName:r}=this.user;this.$refs[e].validate((e=>{if(!e)return console.log("error submit!!"),!1;{const{sex:e}=this.ruleForm;0===e&&(this.ruleForm.sex=null),(0,s.eL)(this.ruleForm).then((e=>{r!==this.ruleForm.userName?this.$message.warning("修改成功,当前登录名已作废, 下次请按新的登录名登录"):this.$message.success("修改成功"),this.$store.dispatch("auth/getInfo"),this.init()}))}}))},resetForm(e){this.$refs[e].resetFields()}}},m=n,c=t(81656),p=(0,c.A)(m,a,l,!1,null,"6d36c597",null),h=p.exports}}]);