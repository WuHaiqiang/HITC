(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22d462"],{f794:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("创建新菜单")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.list,"row-key":"menuId",border:"",fit:"","tree-props":{children:"children"},"highlight-current-row":""}},[a("el-table-column",{attrs:{resizable:!1,label:"菜单id",prop:"menuId",sortable:"custom",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.menuId))])]}}])}),a("el-table-column",{attrs:{resizable:!1,label:"菜单标题",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.meta.title))])]}}])}),a("el-table-column",{attrs:{resizable:!1,label:"菜单名称","min-width":"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.name))])]}}])}),a("el-table-column",{attrs:{resizable:!1,label:"菜单图标",width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("span",[t.meta.icon.startsWith("el-icon")?a("i",{class:t.meta.icon}):a("svg-icon",{attrs:{"icon-class":t.meta.icon}})],1)]}}])}),a("el-table-column",{attrs:{resizable:!1,label:"菜单路径",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.path))])]}}])}),a("el-table-column",{attrs:{resizable:!1,label:"菜单重定向",width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.redirect))])]}}])}),a("el-table-column",{attrs:{resizable:!1,label:"开启面包屑",width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("el-switch",{attrs:{value:t.meta.breadcrumb,"active-color":"#13ce66","inactive-color":"#ccc"}})]}}])}),a("el-table-column",{attrs:{resizable:!1,label:"钉在tags-view",width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("el-switch",{attrs:{value:t.meta.affix,"active-color":"#13ce66","inactive-color":"#ccc"}})]}}])}),a("el-table-column",{attrs:{resizable:!1,fixed:"right",label:"操作",align:"center",width:"230","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,i=t.$index;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleUpdate(n)}}},[e._v(" 编辑 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(n,i)}}},[e._v(" 删除 ")])]}}])})],1),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"500px","margin-left":"50px"},attrs:{rules:e.rules,model:e.temp,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"菜单标题",prop:"title"}},[a("el-input",{model:{value:e.temp.meta.title,callback:function(t){e.$set(e.temp.meta,"title",t)},expression:"temp.meta.title"}})],1),a("el-form-item",{attrs:{label:"菜单名称",prop:"name"}},[a("el-input",{model:{value:e.temp.name,callback:function(t){e.$set(e.temp,"name",t)},expression:"temp.name"}})],1),a("el-form-item",{attrs:{label:"菜单图标"}},[a("el-input",{model:{value:e.temp.meta.icon,callback:function(t){e.$set(e.temp.meta,"icon",t)},expression:"temp.meta.icon"}})],1),a("el-form-item",{attrs:{label:"菜单路径",prop:"path"}},[a("el-input",{model:{value:e.temp.path,callback:function(t){e.$set(e.temp,"path",t)},expression:"temp.path"}})],1),a("el-form-item",{attrs:{label:"重定向地址"}},[a("el-input",{model:{value:e.temp.redirect,callback:function(t){e.$set(e.temp,"redirect",t)},expression:"temp.redirect"}})],1),a("el-form-item",{attrs:{label:"父级菜单"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:function(t){return e.parentMenuChange(t)}},model:{value:e.temp.menuParantId,callback:function(t){e.$set(e.temp,"menuParantId",t)},expression:"temp.menuParantId"}},e._l(e.dataList,(function(e){return a("el-option",{key:e.menuId,attrs:{label:e.meta.title,value:e.menuId}})})),1)],1),a("el-form-item",{attrs:{label:"是否隐藏"}},[a("el-switch",{attrs:{"active-text":"隐藏","inactive-text":"显示"},model:{value:e.temp.hidden,callback:function(t){e.$set(e.temp,"hidden",t)},expression:"temp.hidden"}})],1),a("el-form-item",{attrs:{label:"总是显示"}},[a("el-switch",{attrs:{"active-text":"显示","inactive-text":"不显示"},model:{value:e.temp.alwaysShow,callback:function(t){e.$set(e.temp,"alwaysShow",t)},expression:"temp.alwaysShow"}})],1),a("el-form-item",{attrs:{label:"keep-alive缓存"}},[a("el-switch",{attrs:{"active-text":"缓存","inactive-text":"不缓存"},model:{value:e.temp.meta.noCahce,callback:function(t){e.$set(e.temp.meta,"noCahce",t)},expression:"temp.meta.noCahce"}})],1),a("el-form-item",{attrs:{label:"开启面包屑"}},[a("el-switch",{attrs:{"active-text":"开启","inactive-text":"关闭"},model:{value:e.temp.meta.breadcrumb,callback:function(t){e.$set(e.temp.meta,"breadcrumb",t)},expression:"temp.meta.breadcrumb"}})],1),a("el-form-item",{attrs:{label:"钉在tags-views"}},[a("el-switch",{attrs:{"active-text":"固定","inactive-text":"不固定"},model:{value:e.temp.meta.affix,callback:function(t){e.$set(e.temp.meta,"affix",t)},expression:"temp.meta.affix"}})],1),a("el-form-item",{attrs:{label:"激活菜单"}},[a("el-input",{model:{value:e.temp.meta.activeMenu,callback:function(t){e.$set(e.temp.meta,"activeMenu",t)},expression:"temp.meta.activeMenu"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(" 取消 ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v(" 确认 ")])],1)],1)],1)},i=[],l=a("b85c"),r=(a("14d9"),a("b775")),o=a("da71");function s(){return Object(r["a"])({url:o["a"]+"/admin/menu/getAllTreeMenu",method:"get"})}function c(e){return Object(r["a"])({url:o["a"]+"/admin/menu/saveOrUpdateRole",method:"post",data:e})}function u(e){return Object(r["a"])({url:o["a"]+"/admin/menu/saveOrUpdateRole",method:"post",data:e})}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:o["a"]+"/admin/menu/deleteMenus",method:"post",data:e})}var d=a("ed08"),p={menuId:void 0,name:"",redirect:"",path:"",alwaysShow:!1,hidden:!1,menuParantId:-1,meta:{title:"",icon:"",noCahce:!1,breadcrumb:!0,affix:!1,activeMenu:""},json:""},f={name:"Menu",data:function(){return{list:[],dataList:[],listLoading:!0,currentMenuParent:[],checkedParentNode:void 0,temp:{menuId:void 0,name:"",redirect:"",path:"",alwaysShow:!1,hidden:!1,menuParantId:-1,meta:{title:"",icon:"",noCahce:!1,breadcrumb:!0,affix:!1,activeMenu:""},json:""},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"新增"},rules:{name:[{required:!0,message:"菜单名为必填项",trigger:"change"}],path:[{required:!0,message:"菜单路径为必传项",trigger:"blur"}],meta:{title:[{required:!0,message:"菜单标题为必传项",trigger:"change"}]}},downloadLoading:!1,defaultProps:{children:"children",label:function(e,t){return e.meta.title}}}},created:function(){this.getList()},methods:{parentMenuChange:function(e){this.currentMenuParent=e,this.$forceUpdate()},getList:function(){var e=this;this.listLoading=!0,s().then((function(t){e.listLoading=!1,e.list=t.data,e.dataList=e.handleList(t.data)}))},handleList:function(e){var t=[];this.toListDF(e,t);var a={menuId:-1,name:"first-menu",meta:{title:"顶级菜单"}};return t.unshift(a),t},toListDF:function(e,t){var a,n=Object(l["a"])(e);try{for(n.s();!(a=n.n()).done;){var i=a.value;t.push(i),0!==i.children.length&&this.toListDF(i.children,t)}}catch(r){n.e(r)}finally{n.f()}},createData:function(){var e=this;this.$refs["dataForm"].validate((function(t){t&&(e.temp.menuId=void 0,c(e.temp).then((function(){e.list.unshift(e.temp),e.dialogFormVisible=!1,e.temp=p,e.getList(),e.$notify({title:"OK",message:"菜单创建成功",type:"success",duration:2e3})})))}))},handleCreate:function(){var e=this;this.dialogStatus="create",this.dialogFormVisible=!0,this.currentMenuParent=[],this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},handleUpdate:function(e){var t=this;this.temp=Object(d["c"])(e),this.dialogStatus="update",this.dialogFormVisible=!0,-1!==e.parentId&&(this.temp.menuParantId=e.parentId),this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},updateData:function(){var e=this;this.$refs["dataForm"].validate((function(t){t&&u(e.temp).then((function(){e.dialogFormVisible=!1,e.temp=p,e.$notify({title:"OK",message:"菜单修改成功",type:"success",duration:2e3}),e.getList()}))}))},handleDelete:function(e,t){var a=this;this.$confirm("确定要删除这个菜单吗?","删除菜单",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(t){m({menuIds:[e.menuId]}).then((function(){a.$notify({title:"OK",message:"删除成功",type:"success",duration:2e3}),a.getList()}))})).catch((function(e){console.error(e)}))}}},h=f,b=a("2877"),v=Object(b["a"])(h,n,i,!1,null,null,null);t["default"]=v.exports}}]);